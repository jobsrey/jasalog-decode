/**
 * MMSI Country Code Mapping
 * Based on ITU-R M.585-8 - Assignment and use of identities in the maritime mobile and maritime mobile-satellite services
 */

const MMSI_COUNTRY_CODES = {
  // Format: [start, end, country_code, country_name]
  ranges: [
    [201000000, 201999999, 'AL', 'Albania'],
    [202000000, 202999999, 'AD', 'Andorra'],
    [203000000, 203999999, 'AT', 'Austria'],
    [204000000, 204999999, 'PT', 'Portugal'],
    [205000000, 205999999, 'BE', 'Belgium'],
    [206000000, 206999999, 'BY', 'Belarus'],
    [207000000, 207999999, 'BG', 'Bulgaria'],
    [208000000, 208999999, 'VA', 'Vatican City'],
    [209000000, 209999999, 'CY', 'Cyprus'],
    [210000000, 210999999, 'CY', 'Cyprus'],
    [211000000, 211999999, 'DE', 'Germany'],
    [212000000, 212999999, 'CY', 'Cyprus'],
    [213000000, 213999999, 'GE', 'Georgia'],
    [214000000, 214999999, 'MD', 'Moldova'],
    [215000000, 215999999, 'MT', 'Malta'],
    [216000000, 216999999, 'AM', 'Armenia'],
    [218000000, 218999999, 'DE', 'Germany'],
    [219000000, 219999999, 'DK', 'Denmark'],
    [220000000, 220999999, 'DK', 'Denmark'],
    [224000000, 224999999, 'ES', 'Spain'],
    [225000000, 225999999, 'ES', 'Spain'],
    [226000000, 226999999, 'FR', 'France'],
    [227000000, 227999999, 'FR', 'France'],
    [228000000, 228999999, 'FR', 'France'],
    [230000000, 230999999, 'FI', 'Finland'],
    [231000000, 231999999, 'FO', 'Faroe Islands'],
    [232000000, 232999999, 'GB', 'United Kingdom'],
    [233000000, 233999999, 'GB', 'United Kingdom'],
    [234000000, 234999999, 'GB', 'United Kingdom'],
    [235000000, 235999999, 'GB', 'United Kingdom'],
    [236000000, 236999999, 'GI', 'Gibraltar'],
    [237000000, 237999999, 'GR', 'Greece'],
    [238000000, 238999999, 'HR', 'Croatia'],
    [239000000, 239999999, 'GR', 'Greece'],
    [240000000, 240999999, 'GR', 'Greece'],
    [241000000, 241999999, 'GR', 'Greece'],
    [242000000, 242999999, 'MA', 'Morocco'],
    [243000000, 243999999, 'HU', 'Hungary'],
    [244000000, 244999999, 'NL', 'Netherlands'],
    [245000000, 245999999, 'NL', 'Netherlands'],
    [246000000, 246999999, 'NL', 'Netherlands'],
    [247000000, 247999999, 'IT', 'Italy'],
    [248000000, 248999999, 'MT', 'Malta'],
    [249000000, 249999999, 'MT', 'Malta'],
    [250000000, 250999999, 'IE', 'Ireland'],
    [251000000, 251999999, 'IS', 'Iceland'],
    [252000000, 252999999, 'LI', 'Liechtenstein'],
    [253000000, 253999999, 'LU', 'Luxembourg'],
    [254000000, 254999999, 'MC', 'Monaco'],
    [255000000, 255999999, 'PT', 'Portugal'],
    [256000000, 256999999, 'MT', 'Malta'],
    [257000000, 257999999, 'NO', 'Norway'],
    [258000000, 258999999, 'NO', 'Norway'],
    [259000000, 259999999, 'NO', 'Norway'],
    [261000000, 261999999, 'PL', 'Poland'],
    [262000000, 262999999, 'ME', 'Montenegro'],
    [263000000, 263999999, 'PT', 'Portugal'],
    [264000000, 264999999, 'RO', 'Romania'],
    [265000000, 265999999, 'SE', 'Sweden'],
    [266000000, 266999999, 'SE', 'Sweden'],
    [267000000, 267999999, 'SK', 'Slovakia'],
    [268000000, 268999999, 'SM', 'San Marino'],
    [269000000, 269999999, 'CH', 'Switzerland'],
    [270000000, 270999999, 'CZ', 'Czech Republic'],
    [271000000, 271999999, 'TR', 'Turkey'],
    [272000000, 272999999, 'UA', 'Ukraine'],
    [273000000, 273999999, 'RU', 'Russia'],
    [274000000, 274999999, 'MK', 'North Macedonia'],
    [275000000, 275999999, 'LV', 'Latvia'],
    [276000000, 276999999, 'EE', 'Estonia'],
    [277000000, 277999999, 'LT', 'Lithuania'],
    [278000000, 278999999, 'SI', 'Slovenia'],
    [279000000, 279999999, 'RS', 'Serbia'],
    [301000000, 301999999, 'AI', 'Anguilla'],
    [303000000, 303999999, 'US', 'United States'],
    [304000000, 304999999, 'AG', 'Antigua and Barbuda'],
    [305000000, 305999999, 'AG', 'Antigua and Barbuda'],
    [306000000, 306999999, 'CW', 'Curaçao'],
    [307000000, 307999999, 'AW', 'Aruba'],
    [308000000, 308999999, 'BS', 'Bahamas'],
    [309000000, 309999999, 'BS', 'Bahamas'],
    [310000000, 310999999, 'BM', 'Bermuda'],
    [311000000, 311999999, 'BS', 'Bahamas'],
    [312000000, 312999999, 'BZ', 'Belize'],
    [314000000, 314999999, 'BB', 'Barbados'],
    [316000000, 316999999, 'CA', 'Canada'],
    [319000000, 319999999, 'KY', 'Cayman Islands'],
    [321000000, 321999999, 'CR', 'Costa Rica'],
    [323000000, 323999999, 'CU', 'Cuba'],
    [325000000, 325999999, 'DM', 'Dominica'],
    [327000000, 327999999, 'DO', 'Dominican Republic'],
    [329000000, 329999999, 'GP', 'Guadeloupe'],
    [330000000, 330999999, 'GD', 'Grenada'],
    [331000000, 331999999, 'GL', 'Greenland'],
    [332000000, 332999999, 'GT', 'Guatemala'],
    [334000000, 334999999, 'HN', 'Honduras'],
    [336000000, 336999999, 'HT', 'Haiti'],
    [338000000, 338999999, 'US', 'United States'],
    [339000000, 339999999, 'JM', 'Jamaica'],
    [341000000, 341999999, 'KN', 'Saint Kitts and Nevis'],
    [343000000, 343999999, 'LC', 'Saint Lucia'],
    [345000000, 345999999, 'MX', 'Mexico'],
    [347000000, 347999999, 'MQ', 'Martinique'],
    [348000000, 348999999, 'MS', 'Montserrat'],
    [350000000, 350999999, 'NI', 'Nicaragua'],
    [351000000, 351999999, 'PA', 'Panama'],
    [352000000, 352999999, 'PA', 'Panama'],
    [353000000, 353999999, 'PA', 'Panama'],
    [354000000, 354999999, 'PA', 'Panama'],
    [355000000, 355999999, 'PA', 'Panama'],
    [356000000, 356999999, 'PA', 'Panama'],
    [357000000, 357999999, 'PA', 'Panama'],
    [358000000, 358999999, 'PR', 'Puerto Rico'],
    [359000000, 359999999, 'SV', 'El Salvador'],
    [361000000, 361999999, 'PM', 'Saint Pierre and Miquelon'],
    [362000000, 362999999, 'TT', 'Trinidad and Tobago'],
    [364000000, 364999999, 'TC', 'Turks and Caicos Islands'],
    [366000000, 366999999, 'US', 'United States'],
    [367000000, 367999999, 'US', 'United States'],
    [368000000, 368999999, 'US', 'United States'],
    [369000000, 369999999, 'US', 'United States'],
    [370000000, 370999999, 'PA', 'Panama'],
    [371000000, 371999999, 'PA', 'Panama'],
    [372000000, 372999999, 'PA', 'Panama'],
    [373000000, 373999999, 'PA', 'Panama'],
    [374000000, 374999999, 'PA', 'Panama'],
    [375000000, 375999999, 'VC', 'Saint Vincent and the Grenadines'],
    [376000000, 376999999, 'VC', 'Saint Vincent and the Grenadines'],
    [377000000, 377999999, 'VC', 'Saint Vincent and the Grenadines'],
    [378000000, 378999999, 'VG', 'British Virgin Islands'],
    [379000000, 379999999, 'VI', 'U.S. Virgin Islands'],
    [401000000, 401999999, 'AF', 'Afghanistan'],
    [403000000, 403999999, 'SA', 'Saudi Arabia'],
    [405000000, 405999999, 'BD', 'Bangladesh'],
    [408000000, 408999999, 'BH', 'Bahrain'],
    [410000000, 410999999, 'BT', 'Bhutan'],
    [412000000, 412999999, 'CN', 'China'],
    [413000000, 413999999, 'CN', 'China'],
    [414000000, 414999999, 'CN', 'China'],
    [416000000, 416999999, 'TW', 'Taiwan'],
    [417000000, 417999999, 'LK', 'Sri Lanka'],
    [419000000, 419999999, 'IN', 'India'],
    [422000000, 422999999, 'IR', 'Iran'],
    [423000000, 423999999, 'AZ', 'Azerbaijan'],
    [425000000, 425999999, 'IQ', 'Iraq'],
    [428000000, 428999999, 'IL', 'Israel'],
    [431000000, 431999999, 'JP', 'Japan'],
    [432000000, 432999999, 'JP', 'Japan'],
    [434000000, 434999999, 'TM', 'Turkmenistan'],
    [436000000, 436999999, 'KZ', 'Kazakhstan'],
    [437000000, 437999999, 'UZ', 'Uzbekistan'],
    [438000000, 438999999, 'JO', 'Jordan'],
    [440000000, 440999999, 'KR', 'South Korea'],
    [441000000, 441999999, 'KR', 'South Korea'],
    [443000000, 443999999, 'PS', 'Palestine'],
    [445000000, 445999999, 'KP', 'North Korea'],
    [447000000, 447999999, 'KW', 'Kuwait'],
    [450000000, 450999999, 'LB', 'Lebanon'],
    [451000000, 451999999, 'KG', 'Kyrgyzstan'],
    [453000000, 453999999, 'MO', 'Macao'],
    [455000000, 455999999, 'MV', 'Maldives'],
    [457000000, 457999999, 'MN', 'Mongolia'],
    [459000000, 459999999, 'NP', 'Nepal'],
    [461000000, 461999999, 'OM', 'Oman'],
    [463000000, 463999999, 'PK', 'Pakistan'],
    [466000000, 466999999, 'QA', 'Qatar'],
    [468000000, 468999999, 'SY', 'Syria'],
    [470000000, 470999999, 'AE', 'United Arab Emirates'],
    [472000000, 472999999, 'TJ', 'Tajikistan'],
    [473000000, 473999999, 'YE', 'Yemen'],
    [475000000, 475999999, 'YE', 'Yemen'],
    [477000000, 477999999, 'HK', 'Hong Kong'],
    [478000000, 478999999, 'BA', 'Bosnia and Herzegovina'],
    [501000000, 501999999, 'AQ', 'Antarctica'],
    [503000000, 503999999, 'AU', 'Australia'],
    [506000000, 506999999, 'MM', 'Myanmar'],
    [508000000, 508999999, 'BN', 'Brunei'],
    [510000000, 510999999, 'FM', 'Micronesia'],
    [511000000, 511999999, 'PW', 'Palau'],
    [512000000, 512999999, 'NZ', 'New Zealand'],
    [514000000, 514999999, 'KH', 'Cambodia'],
    [515000000, 515999999, 'KH', 'Cambodia'],
    [516000000, 516999999, 'CX', 'Christmas Island'],
    [518000000, 518999999, 'CK', 'Cook Islands'],
    [520000000, 520999999, 'FJ', 'Fiji'],
    [523000000, 523999999, 'AU', 'Australia'],
    [525000000, 525999999, 'ID', 'Indonesia'],
    [529000000, 529999999, 'KI', 'Kiribati'],
    [531000000, 531999999, 'LA', 'Laos'],
    [533000000, 533999999, 'MY', 'Malaysia'],
    [536000000, 536999999, 'MP', 'Northern Mariana Islands'],
    [538000000, 538999999, 'MH', 'Marshall Islands'],
    [540000000, 540999999, 'NC', 'New Caledonia'],
    [542000000, 542999999, 'NU', 'Niue'],
    [544000000, 544999999, 'NR', 'Nauru'],
    [546000000, 546999999, 'PF', 'French Polynesia'],
    [548000000, 548999999, 'PH', 'Philippines'],
    [553000000, 553999999, 'PG', 'Papua New Guinea'],
    [555000000, 555999999, 'PN', 'Pitcairn Islands'],
    [557000000, 557999999, 'SB', 'Solomon Islands'],
    [559000000, 559999999, 'AS', 'American Samoa'],
    [561000000, 561999999, 'WS', 'Samoa'],
    [563000000, 563999999, 'SG', 'Singapore'],
    [564000000, 564999999, 'SG', 'Singapore'],
    [565000000, 565999999, 'SG', 'Singapore'],
    [566000000, 566999999, 'SG', 'Singapore'],
    [567000000, 567999999, 'TH', 'Thailand'],
    [570000000, 570999999, 'TO', 'Tonga'],
    [572000000, 572999999, 'TV', 'Tuvalu'],
    [574000000, 574999999, 'VN', 'Vietnam'],
    [576000000, 576999999, 'VU', 'Vanuatu'],
    [577000000, 577999999, 'VU', 'Vanuatu'],
    [578000000, 578999999, 'WF', 'Wallis and Futuna'],
    [601000000, 601999999, 'ZA', 'South Africa'],
    [603000000, 603999999, 'AO', 'Angola'],
    [605000000, 605999999, 'DZ', 'Algeria'],
    [607000000, 607999999, 'SH', 'Saint Helena'],
    [608000000, 608999999, 'SH', 'Saint Helena'],
    [609000000, 609999999, 'BI', 'Burundi'],
    [610000000, 610999999, 'BJ', 'Benin'],
    [611000000, 611999999, 'BW', 'Botswana'],
    [612000000, 612999999, 'CF', 'Central African Republic'],
    [613000000, 613999999, 'CM', 'Cameroon'],
    [615000000, 615999999, 'CG', 'Republic of the Congo'],
    [616000000, 616999999, 'KM', 'Comoros'],
    [617000000, 617999999, 'CV', 'Cape Verde'],
    [618000000, 618999999, 'SH', 'Saint Helena'],
    [619000000, 619999999, 'CI', 'Ivory Coast'],
    [620000000, 620999999, 'KM', 'Comoros'],
    [621000000, 621999999, 'DJ', 'Djibouti'],
    [622000000, 622999999, 'EG', 'Egypt'],
    [624000000, 624999999, 'ET', 'Ethiopia'],
    [625000000, 625999999, 'ER', 'Eritrea'],
    [626000000, 626999999, 'GA', 'Gabon'],
    [627000000, 627999999, 'GH', 'Ghana'],
    [629000000, 629999999, 'GM', 'Gambia'],
    [630000000, 630999999, 'GW', 'Guinea-Bissau'],
    [631000000, 631999999, 'GQ', 'Equatorial Guinea'],
    [632000000, 632999999, 'GN', 'Guinea'],
    [633000000, 633999999, 'BF', 'Burkina Faso'],
    [634000000, 634999999, 'KE', 'Kenya'],
    [635000000, 635999999, 'SH', 'Saint Helena'],
    [636000000, 636999999, 'LR', 'Liberia'],
    [637000000, 637999999, 'LR', 'Liberia'],
    [638000000, 638999999, 'SS', 'South Sudan'],
    [642000000, 642999999, 'LY', 'Libya'],
    [644000000, 644999999, 'LS', 'Lesotho'],
    [645000000, 645999999, 'MU', 'Mauritius'],
    [647000000, 647999999, 'MG', 'Madagascar'],
    [649000000, 649999999, 'ML', 'Mali'],
    [650000000, 650999999, 'MZ', 'Mozambique'],
    [654000000, 654999999, 'MR', 'Mauritania'],
    [655000000, 655999999, 'MW', 'Malawi'],
    [656000000, 656999999, 'NE', 'Niger'],
    [657000000, 657999999, 'NG', 'Nigeria'],
    [659000000, 659999999, 'NA', 'Namibia'],
    [660000000, 660999999, 'RE', 'Réunion'],
    [661000000, 661999999, 'RW', 'Rwanda'],
    [662000000, 662999999, 'SD', 'Sudan'],
    [663000000, 663999999, 'SN', 'Senegal'],
    [664000000, 664999999, 'SC', 'Seychelles'],
    [665000000, 665999999, 'SH', 'Saint Helena'],
    [666000000, 666999999, 'SO', 'Somalia'],
    [667000000, 667999999, 'SL', 'Sierra Leone'],
    [668000000, 668999999, 'ST', 'São Tomé and Príncipe'],
    [669000000, 669999999, 'SZ', 'Eswatini'],
    [670000000, 670999999, 'TD', 'Chad'],
    [671000000, 671999999, 'TG', 'Togo'],
    [672000000, 672999999, 'TN', 'Tunisia'],
    [674000000, 674999999, 'TZ', 'Tanzania'],
    [675000000, 675999999, 'UG', 'Uganda'],
    [676000000, 676999999, 'CD', 'Democratic Republic of the Congo'],
    [677000000, 677999999, 'TZ', 'Tanzania'],
    [678000000, 678999999, 'ZM', 'Zambia'],
    [679000000, 679999999, 'ZW', 'Zimbabwe'],
    [701000000, 701999999, 'AR', 'Argentina'],
    [710000000, 710999999, 'BR', 'Brazil'],
    [720000000, 720999999, 'BO', 'Bolivia'],
    [725000000, 725999999, 'CL', 'Chile'],
    [730000000, 730999999, 'CO', 'Colombia'],
    [735000000, 735999999, 'EC', 'Ecuador'],
    [740000000, 740999999, 'FK', 'Falkland Islands'],
    [745000000, 745999999, 'GF', 'French Guiana'],
    [750000000, 750999999, 'GY', 'Guyana'],
    [755000000, 755999999, 'PY', 'Paraguay'],
    [760000000, 760999999, 'PE', 'Peru'],
    [765000000, 765999999, 'SR', 'Suriname'],
    [770000000, 770999999, 'UY', 'Uruguay'],
    [775000000, 775999999, 'VE', 'Venezuela']
  ]
};

/**
 * Get country information from MMSI
 * @param {number} mmsi - Maritime Mobile Service Identity
 * @returns {object} Country information or null if not found
 */
function getCountryFromMMSI(mmsi) {
  if (!mmsi || typeof mmsi !== 'number') {
    return null;
  }

  // Convert to number if it's a string
  const mmsiNum = parseInt(mmsi);
  
  // Check if MMSI is in valid range (9 digits)
  if (mmsiNum < 100000000 || mmsiNum > 999999999) {
    return null;
  }

  // Find matching range
  for (const [start, end, code, name] of MMSI_COUNTRY_CODES.ranges) {
    if (mmsiNum >= start && mmsiNum <= end) {
      return {
        code: code,
        name: name,
        mmsi: mmsiNum
      };
    }
  }

  return null;
}

/**
 * Get country code from MMSI
 * @param {number} mmsi - Maritime Mobile Service Identity
 * @returns {string|null} Country code or null if not found
 */
function getCountryCodeFromMMSI(mmsi) {
  const country = getCountryFromMMSI(mmsi);
  return country ? country.code : null;
}

/**
 * Get country name from MMSI
 * @param {number} mmsi - Maritime Mobile Service Identity
 * @returns {string|null} Country name or null if not found
 */
function getCountryNameFromMMSI(mmsi) {
  const country = getCountryFromMMSI(mmsi);
  return country ? country.name : null;
}

export {
  getCountryFromMMSI,
  getCountryCodeFromMMSI,
  getCountryNameFromMMSI,
  MMSI_COUNTRY_CODES
};
